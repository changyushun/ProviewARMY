<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>重新導向頁面</title>
<script type="text/javascript">
    function showMsg() {
        var cnt = 5;
        var sslUrl = ("Login.aspx");
        document.getElementById("lnkSSL").href = sslUrl;
        setInterval(function () {
            if (--cnt >= 0)
                document.getElementById("spnCountDown").innerHTML = cnt;
            else
                location.href = sslUrl;
        }, 1000);
    }
    function get(name) {
        if (name = (new RegExp('[?&]' + encodeURIComponent(name) + '=([^&]*)')).exec(location.search))
            return decodeURIComponent(name[1]);
    }

    window.onload = function () {
        var code = decodeURIComponent(getValue('Msg'));
        var message;
        if (code == "Code[100]") {            
            message = "連結已逾期，請重發忘記密碼函。";
        }
        if (code == "Code[101]") {
            message = "使用無效連結，系統將通知管理員。";
        }
        if (code == "Code[102]") {
            message = "使用無效連結，系統將通知管理員。";
        }
        if (code == "Code[103]") {
            message = "使用無效連結，系統將通知管理員。";
        }
        //alert(message);
        document.getElementById("test").innerHTML = message
    }

    function getValue(varname) {
        var url = window.location.href;
        var qparts = url.split("?");
        if (qparts.length == 0) { return ""; }
        var query = qparts[1];
        var vars = query.split("&amp;");
        var value = "";
        for (i = 0; i < vars.length; i++) {
            var parts = vars[i].split("=");
            if (parts[0] == varname) {
                value = parts[1];
                break;
            }
        }
        value = unescape(value);
        value.replace(/\+/g, " ");
        return value;
    }
</script>
<style type="text/css">
div 
{ 
    background-color: #cccccc; border: 2px solid black; 
    padding: 5px; width: 300px; line-height: 150%;
    font-size: 11pt;
}
#spnCountDown { color: red; padding: 4px; }
</style>
</head>
<body onload="showMsg();">
<div>
    <span id="test"></span><br />
可點選<a id="lnkSSL" style="color:#0000FF"> 這裡 </a>直接回到登入頁面。<br />
或請稍候<span id="spnCountDown">5</span>秒，
由系統為您自動轉接。
</div>
</body>
</html>
